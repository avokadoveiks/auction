/* Main menu ‚Äî Mobile Legends inspired */
:root {
  --surface-glass: rgba(18, 24, 44, 0.40);
  --surface-panel: rgba(18, 24, 44, 0.85);
  --border-light: rgba(255, 255, 255, 0.14);
  --text: #eaf0ff;
  --muted: #9fb3ff;
  --accent: #5eead4;
  --shadow-xl: 0 24px 48px rgba(4, 8, 18, 0.55);
  --shadow-md: 0 14px 32px rgba(4, 8, 18, 0.45);
  --radius-xl: 24px;
  --radius-lg: 18px;
  --radius-md: 14px;
  --transition: 0.22s ease;
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
  --rot-safe-top: env(safe-area-inset-top, 0px);
  --rot-safe-right: env(safe-area-inset-right, 0px);
  --rot-safe-bottom: env(safe-area-inset-bottom, 0px);
  --rot-safe-left: env(safe-area-inset-left, 0px);
  --app-height: 100dvh;
  --app-width: 100vw;
  --edge-left: max(clamp(16px, 6vw, 42px), var(--safe-left));
  --edge-right: max(clamp(16px, 6vw, 42px), var(--safe-right));
  /* Base logical size for iPhone 15 landscape */
  --base-w: 852; /* points */
  --base-h: 393; /* points */
  --ui-scale: 1; /* computed below in landscape */
  --content-w: 100vw; /* scaled width in px */
  --content-h: 100dvh; /* scaled height in px */
  --ui-offset-x: 0px; /* centering offset */
  --ui-offset-y: 0px; /* centering offset */
}

/* Portrait: —Ç–µ–ª–µ—Ñ–æ–Ω –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ, –Ω–æ –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ–≤–µ—Ä–Ω—É—Ç */
@media (orientation: portrait) {
	:root {
		--edge-left: max(clamp(16px, 6vw, 42px), var(--rot-safe-left, var(--safe-left)));
		--edge-right: max(clamp(16px, 6vw, 42px), var(--rot-safe-right, var(--safe-right)));
	}
}

/* Landscape: —Ç–µ–ª–µ—Ñ–æ–Ω –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ */
@media (orientation: landscape) {
	:root {
		--edge-left: max(clamp(16px, 6vw, 42px), var(--safe-left));
		--edge-right: max(clamp(16px, 6vw, 42px), var(--safe-right));
    /* Compute scale to fit 852√ó393 into real viewport */
    --scale-x: calc(var(--app-width) / (var(--base-w) * 1px));
    --scale-y: calc(var(--app-height) / (var(--base-h) * 1px));
    --ui-scale: min(var(--scale-x), var(--scale-y));
    --content-w: calc(var(--base-w) * 1px * var(--ui-scale));
    --content-h: calc(var(--base-h) * 1px * var(--ui-scale));
    --ui-offset-x: calc((var(--app-width) - var(--content-w)) / 2);
    --ui-offset-y: calc((var(--app-height) - var(--content-h)) / 2);
	}
}

* { box-sizing: border-box; }

/* Native app behavior: prevent scrolling and text selection */
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: fixed;
  top: 0;
  left: 0;
  background: #0a0f1e;
  touch-action: none;
  overscroll-behavior: none;
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE/Edge legacy */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
}

/* Hide scrollbars in WebKit (iOS Safari/Chrome) */
html::-webkit-scrollbar,
body::-webkit-scrollbar {
  width: 0;
  height: 0;
}

/* Containing canvas for the whole menu (fixed to viewport) */
#gameCanvas {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  min-height: var(--app-height, 100dvh);
  background: transparent;
  overflow: hidden;
  backface-visibility: hidden;
  will-change: transform;
}

  #menu-rotate {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    min-width: 100%;
    min-height: 100%;
    max-width: 100%;
    max-height: 100%;
    overflow: hidden;
    touch-action: none;
    overscroll-behavior: none;
    background: transparent; /* Let #bg show through */
  }

  /* Single background layer: contained within #menu-rotate to avoid viewport overflow */
  #bg {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    background: linear-gradient(180deg, #0a0f1e 0%, #15263a 52%, #0a0f1e 100%);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
  }

  #sparks-canvas {
    position: absolute; /* keep inside canvas to prevent viewport overflow */
    inset: 0;
    z-index: 1; /* above background */
    pointer-events: none;
    opacity: 0.8;
  }

  /* Root UI frame sized to 852√ó393 and scaled to fit */
  @media (orientation: landscape) {
    #ui-root {
      position: absolute;
      width: calc(var(--base-w) * 1px);
      height: calc(var(--base-h) * 1px);
      left: max(var(--ui-offset-x), var(--safe-left));
      top: max(var(--ui-offset-y), var(--safe-top));
      transform-origin: top left;
      transform: scale(var(--ui-scale));
      z-index: 2; /* above background/effects */
      overflow: hidden;
      pointer-events: auto;
    }
  }

  .bg-overlay,
  .bg-hammer {
    position: fixed;
    inset: 0;
    pointer-events: none;
    display: none; /* –°–∫—Ä—ã—Ç, —Ç–∞–∫ –∫–∞–∫ –º–æ–ª–æ—Ç —É–∂–µ –Ω–∞ —Ñ–æ–Ω–µ */
  }

  .bg-overlay { z-index: -1; background: radial-gradient(1100px 740px at 48% 55%, rgba(5,8,16,0) 0%, rgba(5,8,16,0.28) 56%, rgba(5,8,16,0.6) 100%); }
  .bg-hammer { z-index: 0; }
  .bg-hammer::before {
    content: "üî®";
    position: absolute;
    right: 6vw;
    top: 18vh;
    font-size: min(22vw, 280px);
    filter: drop-shadow(0 0 10px rgba(0,255,255,.5)) drop-shadow(0 0 24px rgba(255,0,153,.35));
    opacity: 0.16;
    transform: rotate(-15deg);
    animation: hammer-glow 5.8s ease-in-out infinite;
  }

  @keyframes hammer-glow {
    0%, 100% { filter: drop-shadow(0 0 8px rgba(0,255,255,.35)) drop-shadow(0 0 18px rgba(255,0,153,.25)); opacity: 0.12; }
    50% { filter: drop-shadow(0 0 16px rgba(0,255,255,.65)) drop-shadow(0 0 32px rgba(255,0,153,.45)); opacity: 0.22; }
  }

  .menu-screen {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
    box-sizing: border-box;
    padding: clamp(12px, 3vh, 20px) 0 0 0; /* –¢–æ–ª—å–∫–æ –≤–µ—Ä—Ö–Ω–∏–π padding */
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: clamp(12px, 2vh, 20px);
    overflow: hidden;
    touch-action: none;
  }

  .menu-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: clamp(14px, 4vw, 32px);
    background: transparent;
  }

  /* Clean topbar (transparent) */
  .topbar { display: flex; align-items: center; justify-content: space-between; gap: 16px; width: 100%; padding-left: 0; padding-right: 0; }
  .topbar__left { display: flex; align-items: center; gap: 12px; min-width: 0; }
  .topbar__right { display: flex; align-items: center; gap: 10px; }

  /* Landscape: apply padding only to left-side elements, keep right elements at edge */
    @media screen and (orientation: landscape) {
    .topbar__left {
      /* Left side: add safe-area margin */
      margin-left: max(clamp(16px, 6vw, 48px), var(--safe-left));
    }
    .topbar__right {
      /* Right side stays at edge - add safe-area margin */
      margin-right: max(clamp(16px, 6vw, 48px), var(--safe-right));
    }
    .menu-content {
      padding-left: max(clamp(16px, 6vw, 48px), var(--safe-left));
    }
    .menu-bottom { 
      bottom: 0 !important;
      padding: 4px 12px 0;
      padding-left: max(clamp(12px, 5vw, 40px), var(--safe-left));
      padding-right: max(clamp(12px, 5vw, 40px), var(--safe-right));
    }
    .left-panel { padding-left: 0; }
  }
  .avatar-small { width: 42px; height: 42px; border-radius: 50%; background: rgba(255,255,255,0.12); box-shadow: inset 0 0 0 2px rgba(255,255,255,0.12); display: grid; place-items: center; font-size: 18px; color: #0b1020; overflow: hidden; }
  .avatar-small.has-image { color: transparent; background: rgba(17, 23, 41, 0.65); background-size: cover; background-position: center; }
  .user-block { display: inline-flex; flex-direction: column; gap: 2px; max-width: 52vw; }
  .user-name { display: inline-block; font-weight: 600; font-size: 16px; letter-spacing: .02em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .user-balance { color: var(--muted); font-size: 12px; font-weight: 400; }
  /* Transparent single balance line (no panel, no glow) */
  .user-balance-line { display: inline-flex; align-items: center; gap: 8px; padding: 0; background: transparent; border: 0; }
  .coin-icon { width: 16px; height: 16px; border-radius: 50%; display: inline-block; background: radial-gradient(35% 35% at 30% 30%, #fff8d1 0%, #ffe27a 25%, #f9c846 45%, #e2a93a 65%, #b27721 100%); box-shadow: 0 0 4px rgba(255,215,0,0.3), inset 0 0 3px rgba(255,255,255,0.4); }
  .coin-value { font-weight: 800; color: #ffe8a3; font-variant-numeric: tabular-nums; }

  /* Main content grid: left | center (right friends removed from grid) */
  .menu-content { display: grid; grid-template-columns: clamp(50px, 12vw, 70px) 1fr; align-items: start; gap: clamp(14px, 4vw, 32px); position: relative; }
  .menu-center { min-height: 120px; }

  /* Left panel */
  .left-panel { display: flex; flex-direction: column; gap: 10px; align-items: stretch; justify-content: flex-start; padding-left: 0; }
  .left-panel__actions { 
    display: flex; 
    flex-wrap: wrap; /* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–Ω–æ—Å –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É */
    gap: 6px; 
    width: 100%; 
    max-width: 100%; /* –£–±–∏—Ä–∞–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ */
    justify-content: flex-start;
  }
  
  .btn--panel { 
    justify-content: center; 
    text-align: center; 
    padding: 6px 4px;
    flex-direction: column;
    gap: 3px;
    min-height: 56px;
    align-items: center;
    flex: 0 0 auto;
    min-width: 50px;
  }
  
  .btn--panel .btn-icon {
    font-size: clamp(16px, 3.5vw, 20px);
    display: block;
    line-height: 1;
  }
  
  .btn--panel .btn-label {
    font-size: clamp(7px, 1.4vw, 9px);
    display: block;
    line-height: 1.1;
    font-weight: 700;
    text-align: center;
    word-wrap: break-word;
    max-width: 100%;
  }
  
  /* Adaptive font size for long words */
  #realestateBtn .btn-label {
    font-size: clamp(6px, 1.2vw, 8px);
  }

  /* Unified buttons */
  .btn { 
    appearance: none; 
    -webkit-appearance: none; 
    padding: 12px 14px; 
    border-radius: 18px; 
    border: 1px solid rgba(255,255,255,0.16); 
    background: linear-gradient(135deg, rgba(36,46,78,0.85), rgba(22,30,56,0.7)); 
    color: var(--text); 
    font-weight: 700; 
    letter-spacing: .02em; 
    cursor: pointer; 
    display: inline-flex; 
    align-items: center; 
    justify-content: center; 
    gap: 8px; 
    box-shadow: 0 14px 28px rgba(8, 16, 34, 0.45); 
    transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition), filter var(--transition);
    /* Allow interaction on buttons */
    touch-action: manipulation;
    -webkit-user-select: none;
    user-select: none;
  }
  .btn:hover { transform: translateY(-2px); box-shadow: 0 18px 32px rgba(14,22,44,0.52); border-color: rgba(255,255,255,0.28); }
  .btn:active { transform: translateY(-1px) scale(.99); }
  .btn:disabled { opacity: .6; cursor: default; filter: grayscale(.15); }
  .btn--panel { width: 100%; }

  /* Friends toggle rotation */
  .friends-toggle { justify-content: space-between; font-weight: 700; }
  .friends-toggle__icon { transition: transform var(--transition); }
  .friends-toggle[aria-expanded="true"] .friends-toggle__icon { transform: rotate(90deg); }

  /* Bottom area */
  .menu-bottom { 
    position: absolute !important; /* –í–Ω—É—Ç—Ä–∏ #menu-rotate, –∞ –Ω–µ viewport */
    left: 0 !important; 
    right: 0 !important; 
    bottom: 0 !important; 
    display: flex; 
    flex-direction: row; 
    align-items: center; 
    justify-content: space-between; 
    gap: 8px; 
    padding: 0 12px;
    padding-left: max(12px, var(--safe-left, 0px)); 
    padding-right: max(12px, var(--safe-right, 0px)); 
    margin: 0;
    height: 60px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */
    z-index: 1000 !important; 
    background: transparent; /* show full background image under buttons */
  }
  /* Soft fade above footer without affecting the very bottom line */
  /* remove overlays to keep background image visible */
  .menu-bottom::before { display: none; }
  .menu-bottom::after { display: none; }
  .menu-bottom__nav { 
    display: flex; 
    flex-wrap: wrap; /* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–Ω–æ—Å –∫–Ω–æ–ø–æ–∫ */
    gap: 4px; 
    justify-content: flex-start;
    align-items: center;
    margin-left: 20px;
    margin-bottom: 0;
  }
  .nav-button { 
    flex: 0 0 auto; /* –ù–µ —Ä–∞—Å—Ç—è–≥–∏–≤–∞—Ç—å, –Ω–µ —Å–∂–∏–º–∞—Ç—å */
    width: 44px; 
    height: 42px; 
    padding: 3px 4px; 
    border-radius: 9px; 
    flex-direction: column; 
    gap: 2px; 
    font-size: 9px;
    box-shadow: none !important;
    border: none !important;
  }
  .nav-button__icon { font-size: 14px; opacity: 0.95; line-height: 1; }
  .nav-button__label { font-size: 7px; letter-spacing: .005em; opacity: 0.9; line-height: 1.1; }
  .menu-actions { display: flex; align-items: center; justify-content: flex-end; gap: 8px; }
  .cta { position: relative; min-width: 0; padding: 10px 16px; border: none; color: #fff; font-weight: 800; font-size: 12px; letter-spacing: .06em; text-shadow: 0 0 10px rgba(255,255,255,.55); }
  .cta--secondary { background: linear-gradient(135deg, #50608a, #3a4668); box-shadow: 0 12px 24px rgba(40, 56, 104, 0.45); }
  .cta--secondary:hover { box-shadow: 0 16px 28px rgba(40, 56, 104, 0.55); }
  .cta--primary { min-width: 100px; padding: 12px 20px; background: linear-gradient(135deg, #35d47a, #28a745); box-shadow: 0 0 15px rgba(50,255,100,0.6), 0 18px 32px rgba(22, 96, 48, 0.55); border-radius: 12px; clip-path: polygon(10% 0%, 100% 0%, 90% 100%, 0% 100%); }
  .cta--primary:hover { box-shadow: 0 0 22px rgba(50,255,100,0.75), 0 20px 36px rgba(22, 96, 48, 0.6); }

  .player-dock {
    display: flex;
    flex-direction: column;
    gap: 14px;
    padding: clamp(12px, 2vh, 18px);
    border-radius: var(--radius-lg);
    border: 1px solid rgba(255,255,255,0.08);
    background: linear-gradient(135deg, rgba(18,24,44,0.44), rgba(15,20,36,0.2));
    box-shadow: var(--shadow-md);
    backdrop-filter: blur(12px);
  }

  .player-dock__primary {
    display: flex;
    align-items: center;
    gap: clamp(12px, 3vw, 26px);
  }

  .player-dock__avatar {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }

  .player-avatar {
    width: clamp(54px, 11vw, 64px);
    height: clamp(54px, 11vw, 64px);
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.12);
    display: grid;
    place-items: center;
    font-size: clamp(22px, 6vw, 30px);
    color: #0b1020;
    overflow: hidden;
    box-shadow: inset 0 0 0 2px rgba(255,255,255,0.12);
    transition: transform 0.26s ease;
  }

  .player-avatar.has-image { color: transparent; }
  .player-avatar:hover { transform: translateY(-1px) scale(1.04); }

  .bank-pill {
    min-width: 0;
    padding: 6px 16px;
    border-radius: 999px;
    border: 1px solid rgba(94,234,212,0.45);
    background: linear-gradient(135deg, rgba(94,234,212,0.35), rgba(34,211,238,0.32));
    color: var(--text);
    font-weight: 600;
    font-size: 13px;
    cursor: pointer;
    box-shadow: 0 10px 22px rgba(26,200,200,0.28);
    transition: transform var(--transition), box-shadow var(--transition);
  }

  .bank-pill:hover { transform: translateY(-1px); box-shadow: 0 14px 28px rgba(34,211,238,0.34); }
  .bank-pill:active { transform: translateY(0); }

  .player-details {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .player-name { font-weight: 700; font-size: clamp(18px, 5vw, 22px); letter-spacing: 0.03em; }
  .player-balance { color: var(--muted); font-size: clamp(14px, 3.6vw, 16px); }

  .player-dock__quick {
    display: flex;
    gap: clamp(10px, 3vw, 18px);
  }

  .quick-action {
    flex: 0 0 clamp(84px, 18vw, 120px);
    display: grid;
    place-items: center;
    padding: 10px 12px;
    border-radius: var(--radius-md);
    border: 1px solid rgba(255,255,255,0.16);
    background: linear-gradient(135deg, rgba(36,46,78,0.8), rgba(22,30,56,0.68));
    color: var(--text);
    font-weight: 600;
    letter-spacing: 0.03em;
    cursor: pointer;
    box-shadow: 0 14px 26px rgba(8,16,34,0.45);
    transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
  }

  .quick-action__icon { font-size: 20px; margin-bottom: 4px; display: block; }
  .quick-action__label { font-size: 13px; }
  .quick-action:hover { transform: translateY(-2px); box-shadow: 0 18px 32px rgba(14,22,44,0.52); border-color: rgba(255,255,255,0.28); }

  .menu-header__meta {
    display: flex;
    align-items: center;
    gap: clamp(10px, 2.6vw, 18px);
  }

  .top-icon {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    border: 1px solid rgba(255,255,255,0.16);
    background: rgba(255,255,255,0.08);
    color: var(--text);
    font-size: 18px;
    cursor: pointer;
    display: grid;
    place-items: center;
    transition: transform var(--transition), background var(--transition), border-color var(--transition);
  }

  .top-icon:hover { transform: translateY(-2px); background: rgba(255,255,255,0.12); border-color: rgba(255,255,255,0.26); }

  /* Rules button with text */
  #rulesBtn {
    width: auto;
    padding: 0 12px;
    border-radius: 20px;
    gap: 4px;
    display: flex;
    align-items: center;
    font-size: 13px;
    font-weight: 600;
    white-space: nowrap;
  }

  #reloadBtn {
    animation: none;
  }

  #reloadBtn:active {
    animation: spin 0.5s ease-out;
  }

  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .version-badge {
    padding: 4px 10px;
    border-radius: 12px;
    background: rgba(94,234,212,0.15);
    border: 1px solid rgba(94,234,212,0.35);
    font-size: 11px;
    font-weight: 600;
    color: #5eead4;
    letter-spacing: 0.03em;
    white-space: nowrap;
  }

  .resource-chip {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 10px 14px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.18);
    background: linear-gradient(135deg, rgba(32,40,72,0.66), rgba(18,24,44,0.54));
    font-weight: 600;
    letter-spacing: 0.02em;
    box-shadow: 0 12px 24px rgba(10,18,36,0.45);
  }

  .resource-chip__icon { font-size: 18px; }
  .resource-chip__value { font-size: 14px; }

  .menu-main {
    flex: 1;
    display: flex;
    align-items: stretch;
    justify-content: space-between;
    gap: clamp(16px, 5vw, 36px);
  }

  .menu-main__center {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .content-card {
    width: min(320px, 70vw);
    background: linear-gradient(180deg, rgba(27, 34, 63, 0.92), rgba(17, 21, 36, 0.9));
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-light);
    padding: clamp(14px, 3vh, 20px);
    box-shadow: var(--shadow-xl);
    display: flex;
    flex-direction: column;
    gap: 10px;
    backdrop-filter: blur(14px);
  }

  .leaders-card .lc-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-weight: 700;
    letter-spacing: 0.24px;
    color: #ffeaa7;
    font-size: 13px;
  }

  .leaders-card .lc-header .icon { font-size: 18px; }
  .leaders-card .lc-list { display: flex; flex-direction: column; gap: 8px; }

  .leaders-card .lc-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 10px;
    border-radius: 14px;
    background: rgba(255,255,255,0.07);
    border: 1px solid rgba(255,255,255,0.14);
    box-shadow: 0 12px 24px rgba(6, 10, 18, 0.45);
    gap: 10px;
  }

  .leaders-card .lc-left { display: flex; align-items: center; gap: 10px; }
  .leaders-card .lc-medal { font-size: 18px; }
  .leaders-card .lc-ava {
    width: 34px;
    height: 34px;
    border-radius: 50%;
    display: grid;
    place-items: center;
    font-size: 16px;
    background: rgba(255,255,255,0.14);
    box-shadow: inset 0 0 0 1px rgba(255,255,255,0.2);
  }

  .leaders-card .lc-name { font-weight: 600; font-size: 13px; }
  .leaders-card .lc-val { font-weight: 700; font-size: 14px; color: #9dd6ff; font-variant-numeric: tabular-nums; }
  .leaders-card .lc-footer { font-size: 11px; color: var(--muted); text-align: center; margin-top: auto; opacity: 0.85; }

  .friends-panel {
    position: absolute;
    top: 0;
    right: 0;
    margin-right: var(--edge-right);
    width: clamp(160px, 20vw, 220px);
    display: flex;
    flex-direction: column;
    gap: 12px;
    align-items: flex-end;
    z-index: 10;
  }

  /* Friends panel is anchored to the viewport edge via var(--edge-right) */

  .friends-toggle {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    padding: 10px 14px;
    border-radius: var(--radius-md);
    border: 1px solid rgba(255,255,255,0.18);
    background: linear-gradient(135deg, rgba(32,40,72,0.78), rgba(18,24,44,0.64));
    color: var(--text);
    font-weight: 600;
      align-self: flex-end;
    cursor: pointer;
    box-shadow: 0 14px 28px rgba(6, 12, 24, 0.45);
    transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
    width: -moz-fit-content;
    width: fit-content;
    white-space: nowrap;
  }

  .friends-toggle__icon { display: inline-block; transition: transform var(--transition); }
  .friends-toggle[aria-expanded="true"] .friends-toggle__icon { transform: rotate(90deg); }
  .friends-toggle:hover { transform: translateY(-2px); box-shadow: 0 18px 32px rgba(10, 18, 36, 0.5); border-color: rgba(255,255,255,0.3); }

  .friends-list[hidden] { display: none; }

  .friends-list {
    padding: 0;
    border-radius: var(--radius-lg);
    border: 1px solid rgba(255,255,255,0.14);
    background: rgba(12,18,32,0.82);
    backdrop-filter: blur(10px);
    box-shadow: var(--shadow-md);
    display: flex;
    flex-direction: column;
    touch-action: pan-y; /* Allow vertical scrolling if needed */
    -webkit-overflow-scrolling: touch;
  }

  .friends-list__scrollable {
    padding: 12px;
    max-height: clamp(160px, 28vh, 240px);
    overflow-y: auto;
    flex: 1;
  }

  .friends-list__items {
    margin: 0;
    padding: 0;
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .friends-list__item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 6px 8px;
    border-radius: 12px;
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.14);
    font-size: 13px;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,0.05);
    position: relative;
  }

  .friends-list__item--empty {
    opacity: 0.6;
    background: rgba(255,255,255,0.04);
    border-style: dashed;
  }

  .friends-list__item.friend-online {
    border-color: rgba(34,211,238,0.45);
    background: rgba(34,211,238,0.08);
  }

  .friends-list__item.friend-online::before {
    content: '';
    position: absolute;
    left: 4px;
    top: 50%;
    transform: translateY(-50%);
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #22d3ee;
    box-shadow: 0 0 6px #22d3ee;
  }

  .friend-ava {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: grid;
    place-items: center;
    background: rgba(255,255,255,0.12);
    font-size: 15px;
  }

  .friend-name {
    flex: 1;
  }

  .friend-invite-btn {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    border: 1px solid rgba(34,211,238,0.6);
    background: rgba(34,211,238,0.2);
    color: #22d3ee;
    font-size: 16px;
    font-weight: 700;
    display: grid;
    place-items: center;
    cursor: pointer;
    transition: all var(--transition);
    padding: 0;
    line-height: 1;
  }

  .friend-invite-btn:hover {
    background: rgba(34,211,238,0.35);
    transform: scale(1.1);
    box-shadow: 0 0 12px rgba(34,211,238,0.5);
  }

  .friend-invite-btn:active {
    transform: scale(0.95);
  }

  .friends-invite {
    margin-top: 0;
    padding: 10px 12px;
    border-radius: 12px;
    border: 1px solid rgba(94,234,212,0.45);
    background: rgba(34,211,238,0.24);
    color: var(--text);
    font-weight: 600;
    cursor: pointer;
    transition: transform var(--transition), box-shadow var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }

  .friends-add-btn {
    border-top: 1px solid rgba(255,255,255,0.12);
    border-radius: 0 0 var(--radius-lg) var(--radius-lg);
    margin: 0;
  }

  .friends-invite:hover { transform: translateY(-1px); box-shadow: 0 12px 24px rgba(34,211,238,0.32); }

  .add-friend-icon {
    font-size: 20px;
    font-weight: 400;
    line-height: 1;
  }

  /* (Removed old bottom layout overrides to avoid conflicts) */

  /* Popup */
  .leagues-popup { 
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 9999;
  }
  
  .leagues-popup[hidden] { display: none; }

  .leagues-popup__backdrop {
    position: fixed;
    inset: 0;
    background: rgba(4, 8, 16, 0.74);
    backdrop-filter: blur(8px);
    z-index: 10000;
    pointer-events: auto;
  }

/* iOS Safari fix in portrait when rotating wrapper: disable blurs to avoid black screen */
@media screen and (orientation: portrait) {
  .player-dock,
  .friends-list,
  .content-card,
  .leagues-popup__backdrop {
    -webkit-backdrop-filter: none !important;
    backdrop-filter: none !important;
  }

  /* Slightly more opaque backgrounds as fallback while blur is off */
  .player-dock { background: linear-gradient(135deg, rgba(18,24,44,0.66), rgba(15,20,36,0.44)); }
  .friends-list { background: rgba(12,18,32,0.92); }
  .content-card { background: linear-gradient(180deg, rgba(27, 34, 63, 0.96), rgba(17, 21, 36, 0.94)); }
  .leagues-popup__backdrop { background: rgba(4, 8, 16, 0.82); }
}

  .leagues-popup__card {
    position: fixed;
    z-index: 10001;
    bottom: clamp(52px, 10vh, 82px);
    right: clamp(20px, 6vw, 48px);
    width: clamp(320px, 60vw, 420px);
    max-width: 90vw;
    max-height: 80vh;
    background: linear-gradient(180deg, rgba(24, 30, 58, 0.96), rgba(12, 16, 32, 0.92));
    border: 1px solid rgba(255,255,255,0.16);
    border-radius: 24px;
    padding: 16px 18px;
    box-shadow: 0 24px 52px rgba(4, 8, 16, 0.55);
    display: flex;
    flex-direction: column;
    gap: 12px;
    overflow-y: auto;
    pointer-events: auto;
    touch-action: pan-y;
    -webkit-overflow-scrolling: touch;
  }

  .leagues-popup__header { display: flex; align-items: center; justify-content: space-between; gap: 12px; }
  .leagues-popup__title { margin: 0; font-size: 16px; font-weight: 700; letter-spacing: 0.06em; }

  .leagues-popup__close {
    width: 36px;
    height: 36px;
    border-radius: 12px;
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.18);
    color: var(--text);
    font-size: 20px;
    cursor: pointer;
    transition: background var(--transition), transform var(--transition);
  }

  .leagues-popup__close:hover { background: rgba(255,255,255,0.16); }
  .leagues-popup__close:active { transform: scale(0.95); }

  .leagues-popup__list { 
    display: grid; 
    gap: 10px;
    overflow-y: auto;
    max-height: 55vh;
    touch-action: pan-y;
    -webkit-overflow-scrolling: touch;
  }

  .league-choice {
    width: 100%;
    padding: 12px 14px;
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,0.22);
    color: #1b1208;
    text-align: left;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 10px;
    font-weight: 700;
    font-size: 15px;
    cursor: pointer;
    transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
  }

  .league-choice span:last-child { font-size: 12px; font-weight: 600; opacity: 0.85; }
  .league-choice.bronze { background-color: #cd7f32; }
  .league-choice.silver { background-color: #c0c0c0; }
  .league-choice.gold { background-color: #ffd700; }
  .league-choice.diamond { background-color: #b9f2ff; color: #053047; }
  .league-choice.is-selected { border-color: rgba(255,255,255,0.8); box-shadow: 0 18px 32px rgba(0,0,0,0.28); }
  .league-choice.is-locked { opacity: 0.5; cursor: not-allowed; }
  .league-choice:not(.is-locked):hover { transform: translateY(-2px); box-shadow: 0 20px 34px rgba(0,0,0,0.28); }

  /* Feedback popup styles */
  .feedback-body {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 2px 0;
  }

  .feedback-body[hidden] {
    display: none !important;
  }

  .feedback-description {
    margin: 0;
    font-size: 11px;
    color: var(--muted);
    line-height: 1.3;
  }

  .feedback-textarea {
    width: 100%;
    min-height: 85px;
    padding: 8px 10px;
    border-radius: var(--radius-md);
    border: 1px solid rgba(255,255,255,0.14);
    background: rgba(255,255,255,0.05);
    color: var(--text);
    font-family: var(--font);
    font-size: 12px;
    line-height: 1.35;
    resize: vertical;
    transition: border-color var(--transition), background var(--transition);
  }

  .feedback-textarea:focus {
    outline: none;
    border-color: rgba(94,234,212,0.45);
    background: rgba(255,255,255,0.08);
  }

  .feedback-textarea::placeholder {
    color: rgba(255,255,255,0.3);
    font-size: 11px;
  }

  .feedback-counter {
    text-align: right;
    font-size: 10px;
    color: var(--muted);
    margin-top: -4px;
  }

  .feedback-actions {
    display: flex;
    gap: 8px;
    margin-top: 2px;
  }

  .feedback-btn {
    flex: 1;
    padding: 9px 14px;
    border-radius: var(--radius-md);
    border: 1px solid rgba(255,255,255,0.18);
    font-weight: 600;
    font-size: 12px;
    cursor: pointer;
    transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
  }

  .feedback-btn--back {
    background: rgba(255,255,255,0.08);
    color: var(--text);
  }

  .feedback-btn--back:hover {
    background: rgba(255,255,255,0.12);
    border-color: rgba(255,255,255,0.28);
  }

  .feedback-btn--submit {
    background: linear-gradient(135deg, #35d47a, #28a745);
    color: #fff;
    border-color: transparent;
    box-shadow: 0 0 15px rgba(50,255,100,0.3);
  }

  .feedback-btn--submit:hover {
    transform: translateY(-2px);
    box-shadow: 0 0 22px rgba(50,255,100,0.5), 0 8px 16px rgba(22, 96, 48, 0.4);
  }

  .feedback-btn--submit:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }

  .feedback-success {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 16px;
    background: linear-gradient(135deg, rgba(53, 212, 122, 0.15), rgba(40, 167, 69, 0.08));
    border: 1px solid rgba(53, 212, 122, 0.35);
    border-radius: var(--radius-lg);
    text-align: center;
  }

  .feedback-success[hidden] {
    display: none !important;
  }

  .feedback-success-icon {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    font-weight: 700;
    color: #35d47a;
    background: rgba(53, 212, 122, 0.15);
    border-radius: 50%;
    animation: feedbackSuccessBounce 0.6s ease-out;
  }

  .feedback-success-text {
    margin: 0;
    font-size: 14px;
    font-weight: 600;
    color: #35d47a;
  }

  @keyframes feedbackSuccessBounce {
    0% { transform: scale(0); }
    50% { transform: scale(1.2); }
    100% { transform: scale(1); }
  }

  /* Specific styling for feedback popup to make it more compact */
  #feedbackPopup .leagues-popup__card {
    left: 50%;
    right: auto;
    transform: translateX(-50%);
    bottom: clamp(28px, 7vh, 56px);
    width: clamp(340px, 70vw, 450px);
    max-height: 85vh;
    padding: 14px 18px;
    overflow-y: auto;
  }

  /* Bug Report Popup - same styling as feedback */
  #bugReportPopup .leagues-popup__card {
    left: 50%;
    right: auto;
    transform: translateX(-50%);
    bottom: clamp(28px, 7vh, 56px);
    width: clamp(340px, 70vw, 450px);
    max-height: 85vh;
    padding: 14px 18px;
    gap: 10px;
    overflow-y: auto;
  }

  #feedbackPopup .leagues-popup__title {
    font-size: 15px;
    font-weight: 600;
  }

  #feedbackPopup .leagues-popup__close {
    width: 32px;
    height: 32px;
  }

  /* Mode Popup Styles */
  #modePopup .mode-popup__card {
    max-width: 420px;
    width: min(420px, calc(100vw - 40px));
  }

  .mode-popup__body {
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding: 24px 20px;
  }

  .mode-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 20px 24px;
    background: linear-gradient(135deg, rgba(94, 114, 235, 0.12) 0%, rgba(139, 92, 246, 0.12) 100%);
    border: 2px solid rgba(139, 92, 246, 0.3);
    border-radius: var(--radius-lg);
    font-size: 18px;
    font-weight: 600;
    color: var(--text);
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }

  .mode-btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(94, 114, 235, 0.2) 0%, rgba(139, 92, 246, 0.2) 100%);
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .mode-btn:hover {
    transform: translateY(-2px);
    border-color: rgba(139, 92, 246, 0.6);
    box-shadow: 0 8px 24px rgba(139, 92, 246, 0.25), 
                0 0 0 1px rgba(139, 92, 246, 0.1) inset;
  }

  .mode-btn:hover::before {
    opacity: 1;
  }

  .mode-btn:active {
    transform: translateY(0);
    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.2);
  }

  .mode-btn__icon {
    font-size: 28px;
    filter: drop-shadow(0 2px 8px rgba(139, 92, 246, 0.4));
    z-index: 1;
  }

  .mode-btn__label {
    z-index: 1;
    letter-spacing: 0.02em;
  }

  .mode-btn--classic:hover {
    background: linear-gradient(135deg, rgba(94, 114, 235, 0.2) 0%, rgba(139, 92, 246, 0.15) 100%);
  }

  .mode-btn--economic:hover {
    background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(139, 92, 246, 0.15) 100%);
  }

  /* Mode popup transitions */
  #modePopup:not([hidden]) {
    animation: fadeIn 0.25s ease;
  }

  #modePopup:not([hidden]) .mode-popup__card {
    animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes slideUp {
    from { 
      opacity: 0;
      transform: translateY(20px) scale(0.95);
    }
    to { 
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  /* ========================================
     –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ –î–õ–Ø –í–°–ï–• –£–°–¢–†–û–ô–°–¢–í
     ======================================== */

  /* Mobile portrait: 2 –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥ –¥–ª—è –ø–∞–Ω–µ–ª–∏, –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ 2-3 */
  @media (max-width: 600px) {
    .btn--panel {
      flex: 0 0 calc(50% - 3px);
      max-width: calc(50% - 3px);
    }
    
    .nav-button {
      flex: 0 0 auto;
      min-width: 44px;
    }
  }

  /* iPhone 15 Portrait (393x852) */
  @media (max-width: 430px) and (orientation: portrait) {
    .btn--panel {
      flex: 0 0 calc(50% - 3px);
      min-height: 60px;
    }
    
    .menu-bottom__nav {
      padding: 8px 12px;
      gap: 6px;
    }
    
    .nav-button {
      min-width: 48px;
      padding: 8px;
    }
  }

  /* iPhone 15 Landscape (852x393) */
  @media (max-width: 932px) and (orientation: landscape) and (max-height: 430px) {
    .left-panel__actions {
      gap: 4px;
    }
    
    .btn--panel {
      flex: 0 0 calc(25% - 3px);
      min-height: 50px;
      padding: 4px 2px;
    }
    
    .menu-bottom__nav {
      gap: 6px;
    }
  }

  /* Tablet & Mobile landscape: 3-4 –∫–Ω–æ–ø–∫–∏ */
  @media (min-width: 601px) and (max-width: 1199px) {
    .btn--panel {
      flex: 0 0 calc(33.333% - 4px);
      max-width: calc(33.333% - 4px);
    }
  }

  /* Desktop: –±–æ–ª—å—à–∏–µ —ç–∫—Ä–∞–Ω—ã (–æ—Ç 1200px) */
  @media (min-width: 1200px) {
    .menu-screen {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .menu-content {
      grid-template-columns: minmax(80px, 100px) 1fr;
      gap: 24px;
    }
    
    .nav-button {
      padding: 12px 16px;
    }
    
    .nav-button__label {
      font-size: 12px;
    }
  }

  /* Tablet landscape: –ø–ª–∞–Ω—à–µ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ (768px - 1199px) */
  @media (min-width: 768px) and (max-width: 1199px) {
    .menu-screen {
      padding: 20px 24px;
    }
    
    .menu-content {
      grid-template-columns: minmax(70px, 85px) 1fr;
      gap: 18px;
    }
    
    .nav-button {
      padding: 10px 14px;
    }
  }

  /* Tablet portrait: –ø–ª–∞–Ω—à–µ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ (600px - 767px) */
  @media (min-width: 600px) and (max-width: 767px) and (orientation: portrait) {
    .menu-screen {
      padding: 18px 20px;
    }
    
    .menu-header {
      flex-direction: column;
      gap: 12px;
    }
    
    .menu-content {
      grid-template-columns: minmax(60px, 75px) 1fr;
      gap: 16px;
    }
    
    .main-content {
      padding: 18px;
    }
    
    .friends-panel {
      width: 100%;
    }
    
    .menu-bottom {
      flex-direction: row;
      flex-wrap: wrap;
      gap: 12px;
    }
    
    .menu-bottom__nav {
      flex: 1 1 100%;
      justify-content: space-around;
    }
    
    .menu-actions {
      flex: 1 1 100%;
      justify-content: center;
    }
  }

  /* Mobile landscape: —Ç–µ–ª–µ—Ñ–æ–Ω –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ (–¥–æ 767px) */
  @media (max-width: 767px) and (orientation: landscape) {
    .menu-screen {
      padding: 10px 12px;
      gap: 10px;
    }
    
    .menu-header {
      flex-direction: row;
      flex-wrap: nowrap;
    }
    
    .menu-header__meta {
      gap: 8px;
    }
    
    .resource-chip {
      padding: 6px 10px;
      font-size: 11px;
    }
    
    .menu-content {
      grid-template-columns: minmax(50px, 60px) 1fr;
      gap: 12px;
    }
    
    .main-content {
      padding: 12px;
    }
    
    .btn--panel {
      min-height: 45px;
      padding: 4px 2px;
    }
    
    .btn--panel .btn-icon {
      font-size: clamp(12px, 3vw, 16px);
    }
    
    .btn--panel .btn-label {
      font-size: clamp(6px, 1.2vw, 8px);
    }
    
    .menu-bottom {
      flex-direction: row;
      gap: 8px;
      padding: 8px 12px;
    }
    
    .nav-button {
      padding: 6px 8px;
      font-size: 10px;
    }
    
    .nav-button__icon {
      font-size: 16px;
    }
    
    .nav-button__label {
      font-size: 9px;
    }
  }

  /* Mobile portrait: —Ç–µ–ª–µ—Ñ–æ–Ω –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ (–¥–æ 599px) */
  @media (max-width: 599px) and (orientation: portrait) {
    .menu-screen {
      padding: 12px 14px;
      gap: 12px;
    }
    
    .menu-header {
      flex-direction: column;
      align-items: stretch;
      gap: 10px;
    }
    
    .menu-header__meta {
      flex-wrap: wrap;
      gap: 8px;
    }
    
    .resource-chip {
      flex: 1 1 calc(50% - 4px);
      min-width: 90px;
      padding: 8px 10px;
    }
    
    .menu-content {
      grid-template-columns: minmax(50px, 65px) 1fr;
      gap: 12px;
    }
    
    .left-panel {
      gap: 6px;
    }
    
    .btn--panel {
      min-height: 50px;
      padding: 5px 3px;
    }
    
    .btn--panel .btn-icon {
      font-size: clamp(14px, 3.5vw, 18px);
    }
    
    .btn--panel .btn-label {
      font-size: clamp(6px, 1.4vw, 9px);
    }
    
    .main-content {
      padding: 14px;
    }
    
    .friends-panel {
      width: 100%;
      flex-direction: row;
      overflow-x: auto;
      overflow-y: hidden;
    }
    
    .menu-bottom {
      flex-direction: column;
      gap: 10px;
      padding: 12px 14px;
    }
    
    .menu-bottom__nav {
      width: 100%;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 8px;
    }
    
    .nav-button {
      flex: 1 1 calc(33.333% - 6px);
      min-width: 70px;
      padding: 8px 6px;
    }
    
    .nav-button__icon {
      font-size: 18px;
    }
    
    .nav-button__label {
      font-size: 10px;
    }
    
    .menu-actions {
      width: 100%;
      justify-content: center;
      gap: 12px;
    }
    
    .cta {
      flex: 1 1 auto;
      max-width: 180px;
    }
  }

  /* Extra small phones: –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã (–¥–æ 360px) */
  @media (max-width: 360px) {
    .menu-screen {
      padding: 10px 12px;
      gap: 10px;
    }
    
    .resource-chip {
      padding: 6px 8px;
      font-size: 10px;
    }
    
    .btn--panel {
      min-height: 45px;
      padding: 4px 2px;
    }
    
    .btn--panel .btn-icon {
      font-size: clamp(12px, 4vw, 16px);
    }
    
    .btn--panel .btn-label {
      font-size: clamp(6px, 1.5vw, 8px);
    }
    
    .nav-button {
      flex: 1 1 calc(50% - 4px);
      padding: 7px 4px;
    }
    
    .nav-button__label {
      font-size: 9px;
    }
    
    .menu-actions {
      flex-direction: column;
      width: 100%;
    }
    
    .cta {
      width: 100%;
      max-width: 100%;
    }
  }

  /* Mode popup –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
  @media (max-width: 599px) {
    #modePopup .mode-popup__card {
      width: calc(100vw - 32px);
      max-width: 100%;
    }
    
    .mode-popup__body {
      padding: 18px 16px;
      gap: 14px;
    }
    
    .mode-btn {
      padding: 16px 18px;
      font-size: 16px;
    }
    
    .mode-btn__icon {
      font-size: 24px;
    }
  }

  @media (max-width: 360px) {
    .mode-popup__body {
      padding: 14px 12px;
      gap: 12px;
    }
    
    .mode-btn {
      padding: 14px 16px;
      font-size: 15px;
      gap: 10px;
    }
    
    .mode-btn__icon {
      font-size: 22px;
    }
  }

  /* OLD RESPONSIVE (–æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏) */
  @media (max-width: 860px) {
    .menu-screen { padding: 16px 18px; gap: 16px; }
    .menu-header { flex-direction: column; align-items: stretch; }
    .menu-header__meta { justify-content: space-between; }
    /* Keep left column visible even on small widths */
    .menu-content { grid-template-columns: clamp(50px, 12vw, 70px) 1fr; grid-auto-rows: auto; }
    .left-panel { flex-direction: column; align-items: stretch; justify-content: flex-start; gap: 6px; }
    .left-panel__actions { display: flex; flex-direction: column; gap: 5px; width: 100%; max-width: 100%; }
    
    .btn--panel {
      min-height: 50px;
      padding: 5px 3px;
    }
    
    .btn--panel .btn-icon {
      font-size: clamp(14px, 3vw, 18px);
    }
    
    .btn--panel .btn-label {
      font-size: clamp(6px, 1.3vw, 8px);
    }
    
    #realestateBtn .btn-label {
      font-size: clamp(5px, 1.1vw, 7px);
    }
    
  /* Keep compact friends strip on small screens */
  .friends-panel { width: auto; top: 0; }
    .menu-bottom { width: 100%; }
  }

  @media (max-width: 600px) {
    .menu-header__meta { flex-wrap: wrap; }
    /* Do not expand friends strip; keep it content width */
    .friends-panel { width: auto; }
    .menu-bottom { flex-direction: row; align-items: center; justify-content: space-between; }
    .menu-bottom__nav { justify-content: flex-start; }
    .nav-button { flex: 0 0 auto; }
    .menu-actions { justify-content: flex-end; }
    .leagues-popup__card { left: 50%; transform: translateX(-50%); right: auto; width: min(340px, calc(100vw - 40px)); bottom: clamp(44px, 12vh, 80px); }
  }

  @media (max-width: 420px) {
    .menu-content { gap: 12px; }
    .menu-header__meta { gap: 12px; }
    .resource-chip { padding: 8px 12px; }
    .menu-bottom { flex-direction: column; gap: 10px; }
    .menu-bottom__nav { width: 100%; justify-content: center; }
    .nav-button { flex: 1 1 auto; min-width: 65px; }
    .menu-actions { width: 100%; justify-content: center; gap: 12px; }
    
    .btn--panel {
      min-height: 45px;
      padding: 4px 2px;
    }
    
    .btn--panel .btn-icon {
      font-size: clamp(12px, 3.5vw, 15px);
    }
    
    .btn--panel .btn-label {
      font-size: clamp(6px, 1.3vw, 7px);
    }
    
    #realestateBtn .btn-label {
      font-size: clamp(5px, 1.1vw, 6px);
    }
  }

  /* Compact menu for short landscape heights (iPhone landscape) */
  @media (max-height: 540px) and (orientation: landscape) {
    .menu-screen { padding: 12px 16px; gap: 12px; }
    .topbar__left { gap: 8px; }
    .avatar-small { width: 36px; height: 36px; font-size: 16px; }
    .user-name { font-size: clamp(16px, 4vw, 18px); }
    .resource-chip { padding: 8px 10px; }
    .top-icon { width: 36px; height: 36px; font-size: 16px; }

    .menu-content { gap: 12px; }
    
    .btn--panel {
      min-height: 48px;
      padding: 4px 3px;
      gap: 2px;
    }
    
    .btn--panel .btn-icon {
      font-size: clamp(12px, 3vw, 16px);
    }
    
    .btn--panel .btn-label {
      font-size: clamp(6px, 1.2vw, 7px);
    }
    
    #realestateBtn .btn-label {
      font-size: clamp(5px, 1vw, 6px);
    }

  .friends-panel { top: 0; }
    .friends-toggle { padding: 8px 10px; }

    .menu-bottom { gap: 12px; }
    .menu-bottom__nav { gap: 12px; }
    .nav-button { width: clamp(80px, 20vw, 108px); padding: 10px 8px; }
    .nav-button__label { font-size: 12px; }
    .menu-actions { gap: 12px; }
    .cta { padding: 12px 18px; }
    .cta--primary { min-width: clamp(140px, 32vw, 200px); padding: 14px 28px; font-size: 16px; }
  }

  @media (max-height: 460px) and (orientation: landscape) {
    .menu-screen { padding: 10px 12px; gap: 10px; }
    .avatar-small { width: 32px; height: 32px; font-size: 14px; }
    .user-balance-line { gap: 6px; }
    .resource-chip { padding: 6px 8px; }
    .top-icon { width: 32px; height: 32px; font-size: 14px; }

    .menu-content { gap: 10px; }
    .left-panel__actions .btn { padding: 8px 10px; font-size: 13px; }

    .friends-toggle { padding: 7px 9px; font-size: 13px; }

    .menu-bottom { gap: 10px; }
    .menu-bottom__nav { gap: 10px; }
    .nav-button { width: clamp(70px, 18vw, 96px); padding: 8px 6px; }
    .nav-button__label { font-size: 11px; }
    .menu-actions { gap: 10px; }
    .cta { padding: 10px 14px; }
    .cta--primary { min-width: clamp(120px, 30vw, 180px); padding: 12px 20px; font-size: 15px; }
  }

  /* Language List Styles */
  .language-list {
    display: none;
    flex-direction: column;
    gap: 6px;
    padding-left: 8px;
    max-height: 156px; /* ~3 items √ó 46px + gaps */
    overflow-y: auto;
    overflow-x: hidden;
    scrollbar-width: thin;
    scrollbar-color: rgba(96, 165, 250, 0.5) rgba(255, 255, 255, 0.1);
    touch-action: pan-y; /* Allow vertical scrolling */
    -webkit-overflow-scrolling: touch;
  }

  .language-list::-webkit-scrollbar {
    width: 6px;
  }

  .language-list::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
  }

  .language-list::-webkit-scrollbar-thumb {
    background: rgba(96, 165, 250, 0.5);
    border-radius: 3px;
  }

  .language-list::-webkit-scrollbar-thumb:hover {
    background: rgba(96, 165, 250, 0.7);
  }

  .language-list.visible {
    display: flex;
  }

  /* Language popup: grid layout */
  #languageList {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
    max-height: clamp(200px, 50vh, 320px);
    overflow-y: auto;
    overflow-x: hidden;
    padding-right: 4px;
  }

  /* Language Choice Button (compact grid style) */
  .language-choice {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 10px 6px;
    gap: 4px;
    background: linear-gradient(135deg, rgba(36, 46, 78, 0.75), rgba(22, 30, 56, 0.6));
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: 12px;
    color: var(--text);
    font-size: 11px;
    font-weight: 600;
    transition: all var(--transition);
    cursor: pointer;
    touch-action: manipulation;
    position: relative;
  }

  .language-choice:hover {
    transform: translateY(-1px);
    border-color: rgba(96, 165, 250, 0.4);
    box-shadow: 0 6px 12px rgba(14, 22, 44, 0.35);
  }

  .language-choice:active {
    transform: translateY(0) scale(0.96);
  }

  .language-choice[data-selected="true"] {
    border-color: rgba(34, 211, 238, 0.6);
    background: linear-gradient(135deg, rgba(34, 211, 238, 0.15), rgba(22, 30, 56, 0.7));
    box-shadow: 0 0 12px rgba(34, 211, 238, 0.25);
  }

  .language-flag {
    font-size: 28px;
    line-height: 1;
  }

  .language-name {
    text-align: center;
    font-size: 10px;
    line-height: 1.2;
  }

  .language-check {
    position: absolute;
    top: 4px;
    right: 4px;
    color: #22d3ee;
    font-size: 14px;
    font-weight: 700;
    line-height: 1;
    text-shadow: 0 0 4px rgba(34, 211, 238, 0.6);
  }

  /* Winners Popup Styles */
  .winners-popup-card {
    max-height: 80vh;
    overflow: hidden;
  }

  .winners-tabs {
    display: flex;
    gap: 8px;
    padding: 12px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }

  .tab-button {
    flex: 1;
    padding: 8px 12px;
    background: linear-gradient(135deg, rgba(36, 46, 78, 0.6), rgba(22, 30, 56, 0.5));
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: 10px;
    color: var(--text);
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition);
  }

  .tab-button:hover {
    border-color: rgba(96, 165, 250, 0.4);
    transform: translateY(-1px);
  }

  .tab-button.active {
    background: linear-gradient(135deg, rgba(34, 211, 238, 0.2), rgba(22, 30, 56, 0.7));
    border-color: rgba(34, 211, 238, 0.6);
    box-shadow: 0 0 12px rgba(34, 211, 238, 0.3);
  }

  .winners-list-container {
    max-height: clamp(300px, 50vh, 500px);
    overflow-y: auto;
    overflow-x: hidden;
    padding: 16px 4px 4px 4px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .winner-row {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 12px;
    background: linear-gradient(135deg, rgba(36, 46, 78, 0.5), rgba(22, 30, 56, 0.4));
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 12px;
    transition: all var(--transition);
  }

  .winner-row:hover {
    border-color: rgba(96, 165, 250, 0.3);
    transform: translateX(4px);
  }

  .winner-avatar {
    width: 40px;
    height: 40px;
    min-height: 100%; 
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
  }

  .winner-summary {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .winner-summary .name {
    font-size: 13px;
    font-weight: 600;
    color: var(--text);
  }

  .winner-summary .details {
    font-size: 11px;
    color: rgba(255, 255, 255, 0.6);
  }

  .winner-summary .amount {
    font-size: 12px;
    font-weight: 700;
    color: #22d3ee;
  }

  .winner-empty {
    text-align: center;
    padding: 40px 20px;
    color: rgba(255, 255, 255, 0.5);
    font-size: 14px;
  }

  /* =====================
     Rules Popup Styles
     ===================== */
  
  .rules-card {
    max-height: 80vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  .rules-body {
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding: 4px 0;
  }

  .rules-column {
    padding: 14px 16px;
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: var(--radius-lg);
    transition: background var(--transition), border-color var(--transition);
  }

  .rules-column:hover {
    background: rgba(255, 255, 255, 0.06);
    border-color: rgba(255, 255, 255, 0.18);
  }

  .rules-column__title {
    margin: 0 0 8px 0;
    font-size: 15px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--text);
  }

  .rules-column__icon {
    font-size: 20px;
    filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.3));
  }

  .rules-column__desc {
    margin: 0 0 8px 0;
    font-size: 13px;
    line-height: 1.5;
    color: rgba(255, 255, 255, 0.75);
  }

  .rules-column__stats {
    font-size: 12px;
    color: rgba(94, 234, 212, 0.8);
    font-family: 'Courier New', monospace;
    padding: 8px 10px;
    background: rgba(94, 234, 212, 0.08);
    border-radius: var(--radius-md);
    border-left: 3px solid rgba(94, 234, 212, 0.4);
  }

  /* Specific positioning for rules popup */
  #rulesPopup .leagues-popup__card {
    left: 50%;
    right: auto;
    transform: translateX(-50%);
    bottom: clamp(20px, 5vh, 40px);
    width: clamp(320px, 65vw, 420px);
    max-width: calc(100vw - 40px);
  }

  /* Fade animation */
  .leagues-popup {
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
  }

  .leagues-popup:not([hidden]) {
    opacity: 1;
    pointer-events: auto;
  }


